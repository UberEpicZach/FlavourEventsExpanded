namespace = FEE_Diseases_Events

#########	BUBONIC PLAGUE	#########
#########	BUBONIC PLAGUE	#########
#########	BUBONIC PLAGUE	#########

# Death's Return
country_event = {
	id = FEE_Diseases_Events.1
	title = FEE_Diseases_Events.1.T
	desc = FEE_Diseases_Events.1.D
	picture = PLAGUE_eventPicture

	fire_only_once = yes

	trigger = {
		is_year = 1448
		NOT = { is_year = 1452 }
		owns = 104
	}

	mean_time_to_happen = {
		days = 180
	}

	goto = 104

	major = yes
	major_trigger = {
		capital_scope = {
			continent = europe
		}
	}

	option = {
		name = FEE_Diseases_Events.1.OPT1
		ai_chance = {
			factor = 75
		}

		custom_tooltip = FEE_DISEASES_BUBONIC_PLAGUE_RETURN_MILAN_START_TT
		104 = {
			add_permanent_province_modifier = {
				name = fee_diseases_small_bubonic_outbreak
				duration = -1
			}
			every_neighbor_province = {
				random = {
					chance = 33
					add_permanent_province_modifier = {
						name = fee_diseases_small_bubonic_outbreak
						duration = -1
					}
				}
			}
		}
	}

	after = {
		hidden_effect = {
			104 = {
				province_event = {
					name = FEE_Diseases_Events.3
					days = 2555 # roughly 3 years after the end
				}
			}
		}
	}
}

# Epidemia Magna
country_event = {
	id = FEE_Diseases_Events.2
	title = FEE_Diseases_Events.2.T
	desc = FEE_Diseases_Events.2.D
	picture = PLAGUE_eventPicture

	fire_only_once = yes

	trigger = {
		is_year = 1450
		NOT = { is_year = 1452 }
		owns = 104
	}

	mean_time_to_happen = {
		days = 180
		modifier = {
			factor = 2
			has_country_flag = has_competent_doctors
		}
	}

	goto = 104

	major = yes
	major_trigger = {
		104 = {
			any_neighbor_province = {
				owned_by = ROOT
			}
		}
	}

	option = {
		name = FEE_Diseases_Events.2.OPT1
		ai_chance = {
			factor = 75
		}

		104 = {
			variable_arithmetic_trigger = {
				custom_tooltip = FEE_DISEASES_BUBONIC_PLAGUE_EPIDEMIA_MAGNA_TT
				hidden_effect = {
					export_to_variable = {
						variable_name = fee_diseases_epidemia_magna_milan_tax
						value = trigger_value:base_tax
					}
					export_to_variable = {
						variable_name = fee_diseases_epidemia_magna_milan_production
						value = trigger_value:base_production
					}
					export_to_variable = {
						variable_name = fee_diseases_epidemia_magna_milan_manpower
						value = trigger_value:base_manpower
					}
					multiply_variable = {
						which = fee_diseases_epidemia_magna_milan_tax
						value = 0.33
					}
					multiply_variable = {
						which = fee_diseases_epidemia_magna_milan_production
						value = 0.33
					}
					multiply_variable = {
						which = fee_diseases_epidemia_magna_milan_manpower
						value = 0.33
					}
					while = {
						limit = {
							check_variable = {
								which = fee_diseases_epidemia_magna_milan_tax
								value = 0.1
							}
						}
						add_base_tax = -1
						subtract_variable = {
							which = fee_diseases_epidemia_magna_milan_tax
							value = 1
						}
					}
					while = {
						limit = {
							check_variable = {
								which = fee_diseases_epidemia_magna_milan_production
								value = 0.1
							}
						}
						add_base_tax = -1
						subtract_variable = {
							which = fee_diseases_epidemia_magna_milan_production
							value = 1
						}
					}
					while = {
						limit = {
							check_variable = {
								which = fee_diseases_epidemia_magna_milan_manpower
								value = 0.1
							}
						}
						add_base_tax = -1
						subtract_variable = {
							which = fee_diseases_epidemia_magna_milan_manpower
							value = 1
						}
					}
					every_neighbor_province = {
						random = {
							chance = 33
							add_base_tax = -1
							add_base_production = -1
							add_base_manpower = -1
						}
					}
				}
			}
		}
	}
}

# End of the Epidemia Magna
province_event = {
	id = FEE_Diseases_Events.3
	title = FEE_Diseases_Events.3.T
	desc = FEE_Diseases_Events.3.D
	picture = PLAGUE_eventPicture

    is_triggered_only = yes
	fire_only_once = yes

	goto = ROOT

	major = yes
	major_trigger = {
		104 = {
			any_neighbor_province = {
				owned_by = ROOT
			}
		}
	}

	option = {
		name = FEE_Diseases_Events.3.OPT1
		ai_chance = {
			factor = 75
		}

        remove_province_modifier = fee_diseases_small_bubonic_outbreak
		add_permanent_province_modifier = {
			name = fee_diseases_small_bubonic_recovery
			duration = 3650
		}
        every_neighbor_province = {
            limit = { has_province_modifier = fee_diseases_small_bubonic_outbreak }
            remove_province_modifier = fee_diseases_small_bubonic_outbreak
			add_permanent_province_modifier = {
				name = fee_diseases_small_bubonic_recovery
				duration = 3650
			}
        }
	}
}

#########	SYPHILIS	#########
#########	SYPHILIS	#########
#########	SYPHILIS	#########

# A New Disease
country_event = {
	id = FEE_Diseases_Events.1000
	title = FEE_Diseases_Events.1000.T
	desc = {
		trigger = {
			121 = {
				OR = {
					controller = {
						culture_group = french
					}
					owner = {
						culture_group = french
					}
				}
			}
		}
		desc = FEE_Diseases_Events.1000.D_French
	}
	desc = {
		trigger = {
			121 = {
				OR = {
					controller = {
						num_of_colonies = 1
					}
					owner = {
						num_of_colonies = 1
					}
				}
			}
		}
		desc = FEE_Diseases_Events.1000.D_Colonial
	}
	picture = PLAGUE_eventPicture

	fire_only_once = yes

	trigger = {
		is_year = 1440
		NOT = { is_year = 1750 }
		owns = 121
		any_country = {
			OR = {
				culture_group = french
				num_of_colonies = 1
			}
			OR = {
				controls = 121
				owns = 121
				121 = {
					sieged_by = PREV
				}
			}
		}
	}

	mean_time_to_happen = {
		years = 1
	}

	goto = 121

	major = yes
	major_trigger = {
		capital_scope = {
			continent = europe
		}
	}

	option = {
		name = FEE_Diseases_Events.1000.OPT1
		ai_chance = {
			factor = 50
		}

		121 = {
			add_base_tax = -2
			add_base_production = -2
			add_base_manpower = -2
			add_permanent_province_modifier = {
				name = fee_diseases_syphilis_outbreak
				duration = 3650
			}
		}
		custom_tooltip = FEE_DISEASES_SYPHILIS_DISEASE_TT
		hidden_effect = {
			116 = {
				province_event = {
					id = FEE_Diseases_Events.1001
					days = 60
					random = 15
				}
			}
			4730 = {
				province_event = {
					id = FEE_Diseases_Events.1001
					days = 60
					random = 15
				}
			}
			115 = {
				province_event = {
					id = FEE_Diseases_Events.1001
					days = 60
					random = 15
				}
			}
			113 = {
				province_event = {
					id = FEE_Diseases_Events.1001
					days = 60
					random = 15
				}
			}
		}
	}
}

# Syphilis outbreaks in Italy
province_event = {
	id = FEE_Diseases_Events.1001
	title = FEE_Diseases_Events.1001.T
	desc = FEE_Diseases_Events.1001.D
	picture = PLAGUE_eventPicture

	is_triggered_only = yes

	goto = ROOT

	option = {
		name = FEE_Diseases_Events.1001.OPT1
		ai_chance = {
			factor = 50
		}

		add_base_tax = -1
		add_base_production = -1
		add_base_manpower = -1
		add_permanent_province_modifier = {
			name = fee_diseases_syphilis_outbreak
			duration = 3650
		}
	}
}

#
#country_event = {
#	id = FEE_Diseases_Events.
#	title = FEE_Diseases_Events..T
#	desc = FEE_Diseases_Events..D
#	picture = PLAGUE_eventPicture
#
#	fire_only_once = yes
#	trigger = {
#	}
#
#
#	mean_time_to_happen = {
#		months = 6
#	}
#
#	option = {
#		name = FEE_Diseases_Events..OPT1
#		ai_chance = {
#			factor = 50
#		}
#
#	}
#
#	option = {
#		name = FEE_Diseases_Events..OPT2
#		ai_chance = {
#			factor = 50
#		}
#
#	}
#}