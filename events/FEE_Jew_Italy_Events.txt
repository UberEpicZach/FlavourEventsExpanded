namespace = FEE_Jew_Italy_Events

#Jews of Sicily
country_event = {
	id = FEE_Jew_Italy_Events.1
	title = FEE_Jew_Italy_Events.1.T
	desc = FEE_Jew_Italy_Events.1.D
	picture = RELIGIOUS_TURMOIL_eventPicture
	
	trigger = {
		NOT = { is_year = 1470 }
		OR = {
			western_sicily_area = {
				owned_by = ROOT
			}
			sicily_area = {
				owned_by = ROOT
			}
		}
		NOT = { has_country_flag = fee_jew_sicily_initial_event }
	}

	immediate = {
		hidden_effect = { set_country_flag = fee_jew_sicily_initial_event }
	}

	mean_time_to_happen = {
		months = 12
	}

	option = {
		name = FEE_Jew_Italy_Events.1.OPT1
		ai_chance = {
			factor = 50
		}

		custom_tooltip = FEE_JEW_SICILY_START_OPPOSE_TT
		add_prestige = 5

		hidden_effect = {
			change_variable = {
				which = FEE_JEW_ITALY_OPPOSE
				value = 10
			}
		}
	}

	option = {
		name = FEE_Jew_Italy_Events.1.OPT2
		ai_chance = {
			factor = 50
		}

		custom_tooltip = FEE_JEW_SICILY_START_APPROVE_TT
		add_legitimacy_equivalent_fee = { value = 5 }

		hidden_effect = {
			change_variable = {
				which = FEE_JEW_ITALY_APPROVE
				value = 10
			}
		}
	}
}

#Savoca
country_event = {
	id = FEE_Jew_Italy_Events.2
	title = FEE_Jew_Italy_Events.2.T
	desc = FEE_Jew_Italy_Events.2.D
	picture = RELIGIOUS_TURMOIL_eventPicture

	fire_only_once = yes

	trigger = {
		is_year = 1470
		owns = 124
	}

	goto = ROOT

	option = {
		name = FEE_Jew_Italy_Events.2.OPT1
		ai_chance = {
			factor = 50
		}

		add_treasury = 25
		add_papal_influence = 25
		hidden_effect = {
			change_variable = {
				which = FEE_JEW_ITALY_OPPOSE
				value = 10
			}
		}
	}

	option = {
		name = FEE_Jew_Italy_Events.2.OPT2
		ai_chance = {
			factor = 50
		}

		if = {
			limit = { ADM = 6 }
			add_adm_power = 100
		}
		else_if = {
			limit = { ADM = 5 }
			add_adm_power = 80
		}
		else_if = {
			limit = { ADM = 4 }
			add_adm_power = 60
		}
		else_if = {
			limit = { ADM = 3 }
			add_adm_power = 40
		}
		else_if = {
			limit = { ADM = 2 }
			add_adm_power = 20
		}
		else_if = {
			limit = { ADM = 1 }
			add_adm_power = 10
		}
		else = {
			add_adm_power = 0
		}
		if = {
			limit = { DIP = 6 }
			add_dip_power = 120
		}
		else_if = {
			limit = { DIP = 5 }
			add_dip_power = 100
		}
		else_if = {
			limit = { DIP = 4 }
			add_dip_power = 80
		}
		else_if = {
			limit = { DIP = 3 }
			add_dip_power = 60
		}
		else_if = {
			limit = { DIP = 2 }
			add_dip_power = 40
		}
		else_if = {
			limit = { DIP = 1 }
			add_dip_power = 20
		}
		else = {
			add_dip_power = 10
		}

		hidden_effect = {
			change_variable = {
				which = FEE_JEW_ITALY_APPROVE
				value = 10
			}
		}
	}
}

#Giudecca of [Root.GetName]
province_event = {
	id = FEE_Jew_Italy_Events.3
	title = FEE_Jew_Italy_Events.3.T
	desc = FEE_Jew_Italy_Events.3.D
	picture = RELIGIOUS_TURMOIL_eventPicture

	trigger = {
		NOT = { is_year = 1470 }
		OR = {
			area = western_sicily_area
			area = sicily_area
		}
		NOT = { province_id = 126 }
		NOT = { has_province_flag = fee_jew_sicily_giudecca_event }
	}

	mean_time_to_happen = {
		years = 2
	}

	goto = ROOT

	immediate = {
		hidden_effect = { set_province_flag = fee_jew_sicily_giudecca_event }
	}

	option = {
		name = FEE_Jew_Italy_Events.3.OPT1
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				owner = {
					check_variable = {
						which = FEE_JEW_ITALY_OPPOSE
						value = 15
					}
				}
			}
			modifier = {
				factor = 2
				owner = { culture_group = iberian }
			}
		}

		owner = {
			add_prestige = 3
			add_papal_influence = 10
			add_mil_power = 10
		}
		hidden_effect = {
			owner = {
				change_variable = {
					which = FEE_JEW_ITALY_OPPOSE
					value = 5
				}
			}
			change_variable = {
				which = FEE_JEW_ITALY_CITY_OPPOSE
				value = 10
			}
			set_province_flag = fee_jew_sicily_giudecca_approved
		}
	}

	option = {
		name = FEE_Jew_Italy_Events.3.OPT2
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				owner = {
					check_variable = {
						which = FEE_JEW_ITALY_APPROVE
						value = 7
					}
				}
			}
		}
		
		owner = { 
			add_legitimacy_equivalent_fee = { value = 3 }
		}
		if = {
			limit = { 
				owner = { ADM = 3 }
			}
			add_base_tax = 1
		}
		if = {
			limit = { 
				owner = { DIP = 3 }
			}
			add_base_production = 1
		}
		if = {
			limit = { 
				owner = { MIL = 3 }
			}
			add_base_manpower = 1
		}

		hidden_effect = {
			change_variable = {
				which = FEE_JEW_ITALY_CITY_APPROVE
				value = 10
			}
			owner = {
				change_variable = {
					which = FEE_JEW_ITALY_APPROVE
					value = 5
				}
			}
		}
	}
}

#Jews of Root.GetName
province_event = {
	id = FEE_Jew_Italy_Events.4
	title = FEE_Jew_Italy_Events.4.T
	desc = FEE_Jew_Italy_Events.4.D
	picture = RELIGIOUS_TURMOIL_eventPicture

	trigger = {
		NOT = { is_year = 1470 }
		has_province_flag = fee_jew_sicily_giudecca_approved
		OR = {
			area = western_sicily_area
			area = sicily_area
		}
		NOT = { has_province_flag = fee_jew_sicily_jews_of_root }
	}

	mean_time_to_happen = {
		months = 12
	}

	goto = ROOT

	immediate = {
		hidden_effect = {
			set_province_flag = fee_jew_sicily_jews_of_root
		}
	}

	option = {
		name = FEE_Jew_Italy_Events.4.OPT1
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				owner = {
					check_variable = {
						which = FEE_JEW_ITALY_OPPOSE
						value = 30
					}
				}
			}
			modifier = {
				factor = 2
				owner = { culture_group = iberian }
			}
		}

		owner = {
			add_papal_influence = 10
			add_years_of_income = 0.083
		}
		remove_development_third_monarch_skill_fee = yes
		add_devastation = 10
		random_neighbor_province = {
			random_list = {
				25 = {
					add_development_third_monarch_skill_fee = yes
				}
				75 = {
					add_devastation = 15
				}
			}
		}
	}

	option = {
		name = FEE_Jew_Italy_Events.4.OPT2
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				owner = {
					check_variable = {
						which = FEE_JEW_ITALY_APPROVE
						value = 30
					}
				}
			}
		}

		owner = {
			add_years_of_income = -0.083
		}
		add_permanent_province_modifier = {
			name = italian_jew_allowed_stay
			duration = -1
		}
		if = {
			limit = {
				NOT = { religion = jewish }
			}
			random_list = {
				75 = { change_religion = jewish }
				25 = { add_base_production = 1 }
			}
		}
		else = {
			add_base_production = 1
		}
		add_prosperity = 10
	}
}

#Expulsion of 1492
province_event = {
	id = FEE_Jew_Italy_Events.5
	title = FEE_Jew_Italy_Events.5.T
	desc = FEE_Jew_Italy_Events.5.D
	picture = RELIGIOUS_TURMOIL_eventPicture

	fire_only_once = yes
	trigger = {
		is_year = 1492
		OR = {
			area = western_sicily_area
			area = sicily_area
		}
		NOT = { province_id = 126 }
	}

	major = yes
	major_trigger = {
		italy_region = {
			owned_by = ROOT
		}
	}


	mean_time_to_happen = {
		months = 6
	}

	option = {
		name = FEE_Jew_Italy_Events.5.OPT1
		ai_chance = {
			factor = 75
			modifier = {
				factor = 1.31
				owner = {
					check_variable = {
						which = FEE_JEW_ITALY_OPPOSE
						value = 30
					}
				}
			}
			modifier = {
				factor = 1.25
				owner = { culture_group = iberian }
			}
		}

		owner = {
			add_papal_influence = 5
			add_mil_power = -10
		}
		remove_development_third_monarch_skill_fee = yes
		if = {
			limit = {
				has_province_modifier = italian_jew_allowed_stay
			}
			remove_province_modifier = italian_jew_allowed_stay
		}
		random_list = {
			33 = {
				123 = { 
					random_list = {
						50 =  {add_development_third_monarch_skill_fee = yes }
						50 = { add_prosperity = 5 }
					}
				}
			}
			33 = {
				2984 = { 
					random_list = {
						50 =  {add_development_third_monarch_skill_fee = yes }
						50 = { add_prosperity = 5 }
					}
				}
			}
			33 = {
				1934 = { 
					random_list = {
						50 =  {add_development_third_monarch_skill_fee = yes }
						50 = { add_prosperity = 5 }
					}
				}
			}
		}
	}

	option = {
		name = FEE_Jew_Italy_Events.5.OPT2
		ai_chance = {
			factor = 25
			modifier = {
				factor = 4
				owner = {
					check_variable = {
						which = FEE_JEW_ITALY_APPROVE
						value = 30
					}
				}
			}
		}

		owner = {
			add_dip_power = 10
		}
		if = {
			limit = {
				has_province_modifier = italian_jew_allowed_stay
			}
			remove_province_modifier = italian_jew_allowed_stay
			add_permanent_province_modifier = {
				name = italian_jew_allowed_stay_2
				duration = -1
			}
		}
	}
}

#
#country_event = {
#	id = FEE_Jew_Italy_Events.
#	title = FEE_Jew_Italy_Events..T
#	desc = FEE_Jew_Italy_Events..D
#	picture = RELIGIOUS_TURMOIL_eventPicture
#
#	fire_only_once = yes
#	trigger = {
#		
#	}
#
#
#	mean_time_to_happen = {
#		months = 6
#	}
#
#	option = {
#		name = FEE_Jew_Italy_Events..OPT1
#
#	}
#
#	option = {
#		name = FEE_Jew_Italy_Events..OPT2
#
#	}
#}