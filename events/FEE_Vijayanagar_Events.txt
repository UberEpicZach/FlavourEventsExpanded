namespace = FEE_Vijayanagar_Events

#Deva Raya II, a Patron of Literature
country_event = {
	id = FEE_Vijayanagar_Events.1
	title = FEE_Vijayanagar_Events.1.T
	desc = FEE_Vijayanagar_Events.1.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		has_ruler = "Devaraya II"
		religion = hinduism
		primary_culture = kannada
	}

	mean_time_to_happen = {
		months = 12
	}

	option = {
		name = FEE_Vijayanagar_Events.1.OPT1	#What a fine king he is!
		ai_chance = {
			factor = 75
		}

		add_stability_or_adm_power = yes
		add_prestige_or_monarch_power = { amount = 20 }
		add_ruler_modifier = {
			name = fee_vij_kavisarvabhauma
			duration = -1
		}
	}
}

# Vaishnava and Veerashaiva
country_event = {
	id = FEE_Vijayanagar_Events.2
	title = FEE_Vijayanagar_Events.2.T
	desc = FEE_Vijayanagar_Events.2.D
	picture = ADVISOR_eventPicture

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		is_year = 1425
		NOT = { is_year = 1446 }
	}

	mean_time_to_happen = {
		months = 6
	}

	option = { # Chamarasa
		name = FEE_Vijayanagar_Events.2.OPT1
		ai_chance = {
			factor = 50
		}

		add_adm_power = 15
		define_advisor = {
			type = philosopher
			skill = 2
			discount = yes
			religion = hinduism
			name = "Chamarasa"
			culture = kannada
		}
	}

	option = { # Kumara Vyasa
		name = FEE_Vijayanagar_Events.2.OPT2
		ai_chance = {
			factor = 50
		}

		add_dip_power = 15
		define_advisor = {
			type = philosopher
			skill = 2
			discount = yes
			religion = hinduism
			name = "Kumara Vyasa"
			culture = kannada
		}
	}
}

# Vatasseri Parameshvara Nambudiri
country_event = {
	id = FEE_Vijayanagar_Events.3
	title = FEE_Vijayanagar_Events.3.T
	desc = FEE_Vijayanagar_Events.3.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		is_year = 1380
		NOT = { is_year = 1460 }
	}

	mean_time_to_happen = {
		months = 12
	}

	option = {
		name = FEE_Vijayanagar_Events.3.OPT1
		ai_chance = {
			factor = 75
		}

		add_adm_power = 15
		hidden_effect = {
			country_event = {
				id = FEE_Vijayanagar_Events.4
				days = 120
				random = 45
			}
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.3.OPT2
		ai_chance = {
			factor = 75
		}

		add_dip_power = 15
		hidden_effect = {
			country_event = {
				id = FEE_Vijayanagar_Events.5
				days = 120
				random = 45
			}
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.3.OPT3
		ai_chance = {
			factor = 75
		}

		add_mil_power = 15
		hidden_effect = {
			country_event = {
				id = FEE_Vijayanagar_Events.6
				days = 120
				random = 45
			}
		}
	}
}

# Parameshvara's Landcraft
country_event = {
	id = FEE_Vijayanagar_Events.4
	title = FEE_Vijayanagar_Events.4.T
	desc = FEE_Vijayanagar_Events.4.D
	picture = ADVISOR_eventPicture

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = FEE_Vijayanagar_Events.4.OPT1
		ai_chance = {
			factor = 75
		}

		add_years_of_income = -1
		add_country_modifier = {
			name = fee_vij_parameshvara_adm_focus
			duration = 1825
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.4.OPT2
		ai_chance = {
			factor = 25
		}

		add_adm_power = -15
	}
}

# Mathematical Reverie
country_event = {
	id = FEE_Vijayanagar_Events.5
	title = FEE_Vijayanagar_Events.5.T
	desc = FEE_Vijayanagar_Events.5.D
	picture = ADVISOR_eventPicture

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = FEE_Vijayanagar_Events.5.OPT1
		ai_chance = {
			factor = 75
		}

		add_years_of_income = -1
		add_country_modifier = {
			name = fee_vij_parameshvara_dip_focus
			duration = 1825
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.5.OPT2
		ai_chance = {
			factor = 25
		}

		add_dip_power = -15
	}
}

# Warfare by Numbers
country_event = {
	id = FEE_Vijayanagar_Events.6
	title = FEE_Vijayanagar_Events.6.T
	desc = FEE_Vijayanagar_Events.6.D
	picture = ADVISOR_eventPicture

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = FEE_Vijayanagar_Events.6.OPT1
		ai_chance = {
			factor = 75
		}

		add_years_of_income = -1
		add_country_modifier = {
			name = fee_vij_parameshvara_mil_focus
			duration = 1825
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.6.OPT2
		ai_chance = {
			factor = 25
		}

		add_mil_power = -15
	}
}

# Bahmani's Plunder
country_event = {
	id = FEE_Vijayanagar_Events.7
	title = FEE_Vijayanagar_Events.7.T
	desc = FEE_Vijayanagar_Events.7.D
	picture = SIEGE_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		BAH = {
			capital_scope = {
				controlled_by = ROOT
			}
		}
		NOT = { is_mod_active = "Europa Expanded" }
	}

	option = {
		name = FEE_Vijayanagar_Events.7.OPT1
		ai_chance = {
			factor = 75
		}

		add_years_of_income = 1
		BAH = {
			capital_scope = {
				add_devastation = 50
				add_base_tax = -3
				add_base_production = -3
				add_base_manpower = -3
			}
		}
		capital_scope = {
			add_base_tax = 2
			add_base_production = 2
			add_base_manpower = 2
			if = {
				limit = { has_dlc = "Mandate of Heaven" }
				add_prosperity = 50
			}
		}
	}
}

# Daroji Tank
country_event = {
	id = FEE_Vijayanagar_Events.8
	title = FEE_Vijayanagar_Events.8.T
	desc = FEE_Vijayanagar_Events.8.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		owns = 541
	}

	mean_time_to_happen = {
		months = 24
	}

	option = {
		name = FEE_Vijayanagar_Events.8.OPT1
		ai_chance = {
			factor = 75
		}

		add_adm_power = -25
		add_years_of_income = -0.5
		541 = {
			add_permanent_province_modifier = {
				name = fee_vij_daroji_tank
				duration = -1
			}
			every_neighbor_province = {
				add_permanent_province_modifier = {
					name = fee_vij_daroji_tank_neighbor
					duration = -1
				}
			}
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.8.OPT2
		ai_chance = {
			factor = 25
		}

		add_prestige = -5
	}
}

# Dandanayaka brothers
country_event = {
	id = FEE_Vijayanagar_Events.9
	title = FEE_Vijayanagar_Events.9.T
	desc = FEE_Vijayanagar_Events.9.D
	picture = GENERALS_DISCUSSING_eventPicture

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		is_year = 1424
		NOT = { is_year = 1460 }
		NOT = { has_leader = "Lakkanna Dandanayaka" }
	}

	mean_time_to_happen = {
		months = 6
	}

	option = {
		name = FEE_Vijayanagar_Events.9.OPT1
		ai_chance = {
			factor = 75
		}

		define_general = {
			name = "Lakkanna Dandanayaka"
			fire = 3
			shock = 2
			manuever = 4
			siege = 1
			trait = defensive_planner_personality
		}
		define_advisor = {
			type = diplomat
			skill = 2
			cost_multiplier = 0.5
			culture = ROOT
			religion = ROOT
			name = "Madanna Dandanayaka"
		}
	}
}

# Lord of the Southern Ocean
country_event = {
	id = FEE_Vijayanagar_Events.10
	title = FEE_Vijayanagar_Events.10.T
	desc = FEE_Vijayanagar_Events.10.D
	picture = DIPLOMACY_SIGNING_eventPicture

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		has_leader = "Lakkanna Dandanayaka"
		lanka_area = {
			type = all
			country_or_non_sovereign_subject_holds = ROOT
		}
		south_lanka_area = {
			type = all
			country_or_non_sovereign_subject_holds = ROOT
		}
	}

	mean_time_to_happen = {
		months = 6
	}

	option = {
		name = FEE_Vijayanagar_Events.10.OPT1
		ai_chance = {
			factor = 75
		}

		add_years_of_income = 0.25
		lanka_area = {
			add_province_modifier = {
				name = fee_vij_lord_southern_ocean
				duration = 3650
			}
			add_province_modifier = {
				name = fee_vij_improved_cinnamon_trade
				duration = 3650
			}
		}
		south_lanka_area = {
			add_province_modifier = {
				name = fee_vij_lord_southern_ocean
				duration = 3650
			}
			add_province_modifier = {
				name = fee_vij_improved_cinnamon_trade
				duration = 3650
			}
		}
	}
}

# The voyages of Madanna
country_event = {
	id = FEE_Vijayanagar_Events.11
	title = FEE_Vijayanagar_Events.11.T
	desc = FEE_Vijayanagar_Events.11.D
	picture = SHIP_SAILING_eventPicture

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = VIJ }
		has_dip_advisor_of_level = { level = 2 }
		employed_advisor = {
			category = DIP
			name = "Madanna Dandanayaka"
			skill = 2
		}
	}

	mean_time_to_happen = {
		months = 6
	}

	option = {
		name = FEE_Vijayanagar_Events.11.OPT1
		ai_chance = {
			factor = 75
		}

		add_years_of_income = -0.1
		country_event = {
			id = FEE_Vijayanagar_Events.12
			days = 180
			random = 45
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.11.OPT2
		ai_chance = {
			factor = 25
		}

		add_dip_power = -15
		reduce_estate_burghers_loyalty_effect = yes
	}
}

# Madanna's return
country_event = {
	id = FEE_Vijayanagar_Events.12
	title = FEE_Vijayanagar_Events.12.T
	desc = FEE_Vijayanagar_Events.12.D
	picture = ADVISOR_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_list = {
				50 = { set_country_flag = fee_random_0 }
				50 = { set_country_flag = fee_random_1 }
			}
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.12.OPT1
		trigger = { has_country_flag = fee_random_0 }
		ai_chance = {
			factor = 75
		}

		add_mercantilism_or_monarch_power = { amount = 2 }
		custom_tooltip = FEE_VIJ_DISCOVER_SEA_PROVINCES_GOOD_TT
		hidden_effect = {
			east_indian_ocean_region = { discover_country = ROOT }
			east_china_sea_area = { discover_country = ROOT }
			586 = {
				owner = {
					add_opinion = {
						who = ROOT
						modifier = opinion_export_good
					}
					reverse_add_opinion = {
						who = ROOT
						modifier = opinion_export_good
					}
				}
			}
			596 = {
				owner = {
					add_opinion = {
						who = ROOT
						modifier = opinion_export_good
					}
					reverse_add_opinion = {
						who = ROOT
						modifier = opinion_export_good
					}
				}
			}
			667 = {
				owner = {
					add_opinion = {
						who = ROOT
						modifier = opinion_export_good
					}
					reverse_add_opinion = {
						who = ROOT
						modifier = opinion_export_good
					}
				}
			}
		}
	}

	option = {
		name = FEE_Vijayanagar_Events.12.OPT1
		trigger = { has_country_flag = fee_random_1 }
		ai_chance = {
			factor = 75
		}

		add_mercantilism = -1
		custom_tooltip = FEE_VIJ_DISCOVER_SEA_PROVINCES_BAD_TT
		hidden_effect = {
			east_indian_ocean_region = { discover_country = ROOT }
			south_china_sea_area = { discover_country = ROOT }
			586 = {
				owner = {
					add_opinion = {
						who = ROOT
						modifier = opinion_export_bad
					}
					reverse_add_opinion = {
						who = ROOT
						modifier = opinion_export_bad
					}
				}
			}
			596 = {
				owner = {
					add_opinion = {
						who = ROOT
						modifier = opinion_export_bad
					}
					reverse_add_opinion = {
						who = ROOT
						modifier = opinion_export_bad
					}
				}
			}
			667 = {
				owner = {
					add_opinion = {
						who = ROOT
						modifier = opinion_export_bad
					}
					reverse_add_opinion = {
						who = ROOT
						modifier = opinion_export_bad
					}
				}
			}
		}
	}

	after = {
		hidden_effect = {
			clr_country_flag = fee_random_0
			clr_country_flag = fee_random_1
		}
	}
}

# 
# country_event = {
# 	id = FEE_Vijayanagar_Events.
# 	title = FEE_Vijayanagar_Events..T
# 	desc = FEE_Vijayanagar_Events..D
# 	picture = GOOD_WITH_MONARCH_eventPicture
#
# 	fire_only_once = yes
#
# 	trigger = {
# 		is_or_was_tag = { tag = VIJ }
# 	}
#
# 	mean_time_to_happen = {
# 		months = 12
# 	}
#
# 	option = {
# 		name = FEE_Vijayanagar_Events..OPT1
# 		ai_chance = {
# 			factor = 75
# 		}
#
# 	}
# }